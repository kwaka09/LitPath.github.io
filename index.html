<!DOCTYPE html>
<html lang="en">
<head>
Â  <meta charset="UTF-8">
Â  <title>LitPath</title>
Â  <meta name="viewport" content="width=device-width, initial-scale=1.0">
Â  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
Â  <link rel="stylesheet" href="https://unpkg.com/leaflet-routing-machine/dist/leaflet-routing-machine.css" />
	<style>
		/* Universal: body and container centering for mobile */
@media (max-width: 600px) {
  body {
    padding: 0;
    margin: 0;
  }
  .container {
    /* Center content vertically and horizontally */
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    min-height: 90vh;
    margin: 0 !important;
    padding: 1.2em .6em;
    box-sizing: border-box;
    max-width: 100vw;
    width: 100vw;
  }
  .screen.active {
    padding: 0 !important;
  }
  h1, h2 {
    font-size: 1.4em;
    margin-bottom: 0.5em;
    text-align: center;
  }
}

@media (max-width: 800px) {
  .nav-toggle {
    display: inline-flex;
    background: none;
    border: none;
    color: #fff;
    cursor: pointer;
    align-items: center;
    justify-content: center;
  }
  .navbar-logo-wrap {
    margin-right: 1em;
  }
  .nav-links {
    display: flex;
    flex-direction: row;
    gap: 0.5em;
    align-items: center;
    margin-right: auto;
    margin-left: 0.2em;
    flex-wrap: wrap;
  }
  .nav-actions {
    margin-left: 0.6em;
    display: flex;
    align-items: center;
    gap: 0.3em;
  }
}

/* Mobile navbar: center logo, stack links */
@media (max-width:800px) {
  /* Navbar: Logo + nav buttons horizontal on all screens except very narrow */
/* Main navbar flexbox layout */
.navbar {
  display: flex;
  align-items: center;
  justify-content: flex-start;
  flex-direction: row;
  flex-wrap: wrap;
  background: #232b38;
  color: #fff;
  padding: 0.7em 1em 0.7em 1em;
  width: 100%;
  position: relative;
}

/* Logo */
.navbar-logo-wrap {
  display: flex;
  flex-direction: column;
  align-items: flex-start;
  justify-content: flex-start;
  margin-right: 1em;
}

.navbar-logo {
  font-family: cursive;
  font-size: 1.7em;
  font-weight: bold;
  color: #fde47f;
  white-space: nowrap;
}
/* Nav links: horizontal row */
.nav-links {
  display: flex;
  flex-direction: row;
  gap: 0.6rem;
  align-items: center;
  margin-right: auto;
  margin-left: 0.3em;
}
/* Hamburger menu (nav-toggle) hidden by default */
.nav-toggle {
  display: none;
  margin-top: 0.25em;
  margin-left: 0px;
  font-size: 1.5em;
}
/* Actions on far right */
.nav-actions {
  display: flex;
  gap: 0.5rem;
  align-items: center;
  margin-left: 0.6em;
}

/* On very small screens (optional: stack vertically below 520px) */
@media (max-width: 520px) {
  .navbar {
    flex-direction: row;
    align-items: flex-start;
    flex-wrap: wrap;
  }
  .navbar-logo-wrap {
    margin-bottom: 0px;
    margin-right: 0.7em;
  }
  .nav-links {
    flex-direction: row;
    gap: 0.2em;
  }
  .nav-actions {
    margin-left: 0.2em;
  }
}

	/* Only show nav-actions on desktop */
.nav-actions.nav-desktop-only { display: flex; }
.nav-links .nav-mobile-only { display: none; }
@media (max-width: 800px) {
  .nav-actions.nav-desktop-only { display: none !important; }
  .nav-links .nav-mobile-only { display: block; width: 100%; text-align: left; }
}


}

/* Inputs and buttons full-width and spaced for mobile */
@media (max-width: 600px) {
  .input-group input, .input-group textarea, .input-group select {
    width: 100vw;
    max-width: 98vw;
    font-size: 1.03em;
  }
  button.cta, .center-buttons > button {
    width: 98vw;
    max-width: 280px;
    margin: 0.7em auto;
    font-size: 1.1em;
    padding: 1em 0.1em;
  }
}

/* Map adjustments for mobile centering */
@media (max-width:600px) {
  #mapid, #route-map {
    display: block;
    margin: 1em auto;
    width: 98vw !important;
    max-width: 99vw !important;
    height: 42vh !important;
    border-radius: 10px;
  }
}

/* Route list and feedback spacing on mobile */
@media (max-width:600px) {
  .route-list, #reports-list, .feedback {
    width: 98vw;
    margin: 1em auto;
    font-size: 1.10em;
  }
}

/* Hide scrollbars (optional for aesthetic) */
body::-webkit-scrollbar, .container::-webkit-scrollbar { display:none; }


		/* Responsive nav toggle */
		.nav-links { display:flex; gap:0.6rem; align-items:center; }
		.nav-actions { display:flex; gap:0.5rem; align-items:center; }
		.nav-toggle { display:none; background:none; border:none; color:#fff; cursor:pointer; }
		@media (max-width: 800px) {
			.nav-links { display:none; flex-direction:column; width:100%; padding:0.5rem 0; }
			.nav-links.open { display:flex; }
			.nav-links .nav-link { width:100%; text-align:left; padding:0.6rem 0.5rem; border-radius:6px; }
			.nav-actions { margin-left:0; }
			.nav-toggle { display:inline-flex; align-items:center; justify-content:center; }
			.navbar { align-items:flex-start; }
			.navbar .navbar-logo { flex: 0 0 auto; }
		}
			body.dark-mode { background: #181a20; color: #e0e0e0; }
			body.dark-mode .container { background: #23272f; color: #e0e0e0; box-shadow: 0 4px 24px rgba(0,0,0,0.45); }
			body.dark-mode .navbar { background: #23272f; color: #e0e0e0; }
			body.dark-mode .navbar-logo { color: #ffd700 !important; }
			body.dark-mode .button-ripple, body.dark-mode .main-button, body.dark-mode .cta { background: linear-gradient(87deg,#23272f 60%,#315788 100%); color: #ffd700; border: none; }
			body.dark-mode input, body.dark-mode textarea, body.dark-mode select { background: #23272f; color: #ffd700; border: 1px solid #444; }
			body.dark-mode .route-list li { background: #23272f; color: #ffd700; }
			body.dark-mode .feedback { background: #23272f; border-left: 4px solid #ffd700; color: #ffd700; }
		body {
			font-family: 'Segoe UI', sans-serif;
			margin: 0;
			background: #f4f7fa;
			min-height: 100vh;
			position: relative;
			overflow-x: hidden;
		}
		* { box-sizing: border-box; }
		.map-blurred-bg {
			position: fixed;
			top: 0;
			left: 0;
			right: 0;
			bottom: 0;
			background: url('MapBG.png');
			background-size: cover;
			background-position: center;
			filter: blur(12px) brightness(0.8);
			z-index: 0;
		}
		.map-blur-overlay {
			position: fixed;
			top: 0;
			left: 0;
			right: 0;
			bottom: 0;
			background: rgba(41,83,215,0.07);
			z-index: 1;
			pointer-events: none;
		}

		/* Prevent any horizontal overflow and ensure body fits viewport */
		html, body { max-width: 100%; overflow-x: hidden; }

		/* Debug helpers: enable by adding class `debug-overflow` to <html> or <body> */
		html.debug-overflow *, body.debug-overflow * { outline: 1px solid rgba(255,0,0,0.08); }
		/* Strong clamps to prevent elements from exceeding viewport width */
		img, video, iframe, #mapid, #route-map, .container, .nav-links, .nav-actions { max-width: 100%; }
		/* Allow flex children to shrink to avoid overflow */
		.nav-links, .nav-actions, .navbar > * { min-width: 0; }
		button { min-width: 0; }
		.navbar {
			background: #232b38;
			color: #fff;
			padding: 0.75rem 1rem;
			display: flex;
			flex-wrap: wrap;
			justify-content: space-between;
			align-items: center;
			z-index: 10;
			position: relative;
		}
		.navbar button {
			background: none;
			border: none;
			color: #fff;
			font-weight: bold;
			cursor: pointer;
			font-size: 1rem;
			padding: 0.5em 1.25em;
			position: relative;
			overflow: hidden;
			transition: background 0.15s, color 0.15s, transform 0.1s;
			margin: 0 0.3em;
			display: inline-block;
			text-align: center;
		}
		.navbar button.button-ripple {
			background: linear-gradient(87deg,#315788 60%,#3aa1ec 100%);
			color: #fff;
			border: none;
			border-radius: 32px;
			box-shadow: 0 7px 30px rgba(49,87,136,0.20), 0 1.5px 8px rgba(49,87,136,0.13);
			font-size: 1.05em;
			font-weight: 700;
			transition: background 0.18s, box-shadow 0.25s, transform 0.15s, color 0.20s;
		}
		.navbar button.button-ripple:hover,
		.navbar button.button-ripple:focus {
			background: linear-gradient(87deg,#3aa1ec 15%,#315788 84%);
			color: #fde47f;
			transform: scale(1.04) translateY(-2px);
			box-shadow: 0 12px 48px rgba(58,161,236,0.14), 0 2px 8px rgba(58,161,236,0.12);
		}
		.navbar button.button-ripple:active {
			background: linear-gradient(120deg,#315788 76%,#3aa1ec 43%);
			transform: scale(0.97);
			color: #fff;
		}
		.button-ripple {
			position: relative;
			overflow: hidden;
		}
		.button-ripple span.ripple {
			position: absolute;
			border-radius: 50%;
			transform: scale(0);
			animation: ripple 0.6s linear;
			background-color: #fff4;
			pointer-events: none;
			width: 100px;
			height: 100px;
			opacity: 0.8;
			z-index: 3;
			left: 50%;
			top: 50%;
			margin-left: -50px;
			margin-top: -50px;
		}
		@keyframes ripple {
			to {
				transform: scale(3.5);
				opacity: 0;
			}
		}
		/* Screens: use flow layout so mobile height doesn't overflow */
		.screen {
			opacity: 0;
			transform: translateY(18px);
			transition: opacity 0.35s, transform 0.4s;
			z-index: 100;
			pointer-events: none;
			position: relative;
			background: transparent;
			display: none;
			box-sizing: border-box;
			padding-top: 0;
		}
		.screen.active {
			opacity: 1;
			transform: translateY(0);
			pointer-events: auto;
			position: relative;
			display: block;
			z-index: 100;
		}
		.container {
			width: 100%;
			max-width: 1100px;
			margin: 1.25rem auto;
			background: #fff;
			border-radius: 12px;
			box-shadow: 0 6px 30px rgba(0,0,0,0.09);
			position: relative;
			min-height: 280px;
			z-index: 101;
			padding: 1rem 1.25rem;
			box-sizing: border-box;
		}

		/* Outer section.container is the app wrapper; make it full-bleed so inner .container boxes control margins */
		body > section.container {
			margin: 0;
			padding: 0;
			background: transparent;
			box-shadow: none;
			border-radius: 0;
			max-width: 100%;
		}
Â  Â  h1, h2 { color: #315788; text-align: center; }
Â  Â  .input-group { margin-bottom: 1rem; }
Â  Â  label { display: block; font-weight: 600; margin-bottom: 0.5rem; }
		input, textarea, select {
			width: 100%;
			padding: 0.5rem;
			border-radius: 4px;
			border: 1px solid #bbb;
			box-sizing: border-box;
			margin: 0;
		}
Â  Â  input[list] { background: #eff4fa; font-size:1rem; }
Â  Â  select { background: #eff4fa; font-size:1rem; }
		button.cta {
			background: #315788;
			color: #fff;
			padding: 0.7rem 2rem;
			border: none;
			border-radius: 4px;
			font-size: 1rem;
			font-weight: 600;
			margin-top: 0.5em;
			transition: background 0.18s, transform 0.12s;
			position: relative;
			overflow: hidden;
			display: block;
			margin-left: auto;
			margin-right: auto;
			text-align: center;
		}
		button.cta.button-ripple {
			border-radius: 32px;
			background: linear-gradient(87deg,#315788 60%,#3aa1ec 100%);
			font-size: 1.12em;
			font-weight: 700;
			box-shadow: 0 7px 30px rgba(49,87,136,0.20), 0 1.5px 8px rgba(49,87,136,0.13);
			transition: background 0.18s, box-shadow 0.25s, transform 0.15s, color 0.20s;
		}
		button.cta.button-ripple:hover,
		button.cta.button-ripple:focus {
			background: linear-gradient(87deg,#3aa1ec 15%,#315788 84%);
			color: #fde47f;
			transform: scale(1.04) translateY(-2px);
			box-shadow: 0 12px 48px rgba(58,161,236,0.14), 0 2px 8px rgba(58,161,236,0.12);
		}
		button.cta.button-ripple:active {
			background: linear-gradient(120deg,#315788 76%,#3aa1ec 43%);
			transform: scale(0.97);
			color: #fff;
		}
		.center-buttons > button {
			display: block;
			width: 80%;
			margin: 1.2em auto;
			text-align: center;
			font-size: 1.12em;
			font-weight: 700;
			letter-spacing: 0.015em;
			background: linear-gradient(87deg,#315788 60%,#3aa1ec 100%);
			color: #fff;
			border: none;
			border-radius: 32px;
			box-shadow: 0 7px 30px rgba(49,87,136,0.20), 0 1.5px 8px rgba(49,87,136,0.13);
			transition: background 0.18s, box-shadow 0.25s, transform 0.15s, color 0.20s;
			position: relative;
			padding: 1em 0;
			outline: none;
			overflow: hidden;
			cursor: pointer;
		}
		.center-buttons > button.button-ripple span.ripple,
		button.cta.button-ripple span.ripple,
		.navbar button.button-ripple span.ripple {
			position: absolute;
			border-radius: 50%;
			transform: scale(0);
			animation: ripple 0.6s linear;
			background-color: #fff8;
			pointer-events: none;
			width: 110px;
			height: 110px;
			opacity: 0.8;
			z-index: 3;
			left: 50%;
			top: 50%;
			margin-left: -55px;
			margin-top: -55px;
		}

Â  Â  ul.route-list, ul.help-info { list-style: none; padding: 0; }
Â  Â  ul.route-list li { background: #d1e8f6; padding: 0.75rem; margin: 0.4rem 0; border-radius: 4px; }
		.map-placeholder, #mapid { background: #bdd4e7; border-radius: 8px; }
		#mapid { width: 100%; height: min(60vh, 640px); }
Â  Â  .user-profile-box { padding: 1rem; background: #eff4f9; border-radius: 8px; margin-bottom: 1rem; }
Â  Â  .feedback { background: #e0ffe5; border-left: 4px solid #4caf50; padding: 0.5rem 1rem; margin-top: 1rem; border-radius: 5px;}
Â  Â  section.container { transition: box-shadow 0.32s; }
Â  Â  #route-map-container { margin-top:1.5em; }
		#route-map { width:100%; height: min(60vh, 560px); border-radius:8px; background:#bdd4e7; }

		/* Navbar logo adjustments for readability */
		.navbar-logo { font-size: 1.95em; line-height:1; }

		@media (max-width: 600px) {
			/* reduce logo slightly on narrow phones */
			.navbar-logo { font-size: 1.4em; }
			/* On narrow phones remove left gutter so the white working box hugs left edge */
			.container { margin: 1.25rem 1.25rem 1.25rem 0; padding: 1rem; }
			/* Reduce map height to avoid bottom overflow */
			#mapid, #route-map { height: 45vh; }
			/* tighten navbar button padding to avoid wrap */
			.navbar button { padding: 0.35em 0.6em; font-size: 0.95rem; }
		}

		/* Mobile navbar adjustments to avoid right-side white band */
		@media (max-width: 800px) {
			.nav-actions { margin-left: 0 !important; width: 100%; justify-content: flex-start; padding-top: 0.25rem; }
			.nav-links { padding-left: 0.25rem; padding-right: 0.25rem; }
			.navbar-logo { margin-right: 0.5rem; }
		}
	</style>
Â  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
Â  <script src="https://unpkg.com/leaflet-routing-machine/dist/leaflet-routing-machine.js"></script>
<script>
		// Dark mode toggle
		document.addEventListener('DOMContentLoaded', function() {
  function toggleDarkMode(btn) {
    document.body.classList.toggle('dark-mode');
    btn.innerHTML = document.body.classList.contains('dark-mode') ? 'â˜€' : 'â˜¾';
  }
  var darkModeBtn = document.getElementById('darkModeToggle');
  if (darkModeBtn) darkModeBtn.addEventListener('click', function() { toggleDarkMode(darkModeBtn); });
  var darkModeBtnMobile = document.getElementById('darkModeToggleMobile');
  if (darkModeBtnMobile) darkModeBtnMobile.addEventListener('click', function() { toggleDarkMode(darkModeBtnMobile); });
});

	// Store reports in memory
	const reports = [];

	// Handle report submission
	document.addEventListener('DOMContentLoaded', function() {
		const reportForm = document.querySelector('#report form');
		if (reportForm) {
			reportForm.addEventListener('submit', function(e) {
				e.preventDefault();
				const location = document.getElementById('location').value.trim();
				const desc = document.getElementById('desc').value.trim();
				if (location && desc) {
					reports.push({ location, desc, date: new Date().toLocaleString() });
					updateReportsList();
				}
				document.getElementById('feedback-msg').style.display = 'block';
				reportForm.reset();
			});
		}
	});

	// Update the reports received list
	function updateReportsList() {
		const list = document.getElementById('reports-list');
		if (!list) return;
		if (reports.length === 0) {
			list.innerHTML = '<li>No reports received yet.</li>';
			return;
		}
		list.innerHTML = reports.map(r => `<li><b>${r.location}</b><br>${r.desc}<br><small>${r.date}</small></li>`).join('');
	}

	// Show correct screen and update reports if needed
	function showScreen(screenId) {
		document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
		const el = document.getElementById(screenId);
		if (el) {
			el.classList.add('active');
			if (screenId === 'reports-received') updateReportsList();
		}
	}
</script>
</head>
<body>
Â  <div class="map-blurred-bg"></div>
Â  <div class="map-blur-overlay"></div>
	<nav class="navbar">
  <div class="navbar-logo-wrap">
    <span class="navbar-logo">LitPath</span>
    <button id="navToggle" class="nav-toggle button-ripple" aria-label="Toggle menu">â˜°</button>
  </div>
  <div class="nav-links">
    <button onclick="showScreen('home')" class="nav-link button-ripple">Home</button>
    <button onclick="showScreen('map')" class="nav-link button-ripple">Map</button>
    <button onclick="showScreen('route')" class="nav-link button-ripple">Route Planner</button>
    <button onclick="showScreen('report')" class="nav-link button-ripple">Report Light</button>
    <button onclick="showScreen('reports-received')" class="nav-link button-ripple">Reports Received</button>
    <!-- Add these next 3 inside nav-links for mobile, hide on desktop -->
    <button id="helpMobile" onclick="showScreen('help')" class="nav-link button-ripple nav-mobile-only">â“ Help</button>
    <button id="profileMobile" onclick="showScreen('profile')" class="nav-link button-ripple nav-mobile-only">ğŸ‘¤ Profile</button>
    <button id="darkModeToggleMobile" class="nav-link button-ripple nav-mobile-only" title="Toggle Dark Mode">â˜¾</button>
  </div>
  <div class="nav-actions nav-desktop-only">
    <button id="darkModeToggle" class="button-ripple" title="Toggle Dark Mode">â˜¾</button>
    <button onclick="showScreen('profile')" class="button-ripple" title="Profile">ğŸ‘¤</button>
    <button onclick="showScreen('help')" class="button-ripple" title="Help">â“</button>
  </div>
</nav>


Â  <section class="container">
		<div id="home" class="screen active">
			<div class="container">
				<h1 style="text-align:center; font-family:cursive;">LitPath Map</h1>
				<p style="text-align:center;">Find safe, well-lit walking routes, report broken lights, and help your community stay safe after dark.</p>
				<div class="center-buttons">
					<button class="button-ripple" onclick="showScreen('map')">Find Lighted Routes</button>
					<button class="button-ripple" onclick="showScreen('route')">Plan Your Route</button>
					<button class="button-ripple" onclick="showScreen('report')">Report Lighting Issue</button>
				</div>
			</div>
		</div>
		<div id="reports-received" class="screen">
			<div class="container">
				<h2 style="text-align:center; font-family:cursive;">Reports Received</h2>
				<ul id="reports-list" class="route-list">
					<!-- Reports will be dynamically inserted here -->
				</ul>
			</div>
		</div>
Â  Â  <div id="map" class="screen">
Â  Â  Â  <div class="container">
Â  Â  Â  Â  <h2>View Map of LitPath</h2>
Â  Â  Â  Â  <div id="mapid"></div>
Â  Â  Â  Â  <ul class="route-list">
Â  Â  Â  Â  Â  <li>Harrison Road: Well lit &#x2728;</li>
Â  Â  Â  Â  Â  <li>Shuntug Street: Lights Out &#9888;&#65039;</li>
Â  Â  Â  Â  Â  <li>Abanao Street: Dimly Lit</li>
Â  Â  Â  Â  </ul>
Â  Â  Â  </div>
Â  Â  </div>
Â  Â  <div id="report" class="screen">
			<div class="container">
				<h2>Report Lighting Issues</h2>
				<form>
Â  Â  Â  Â  Â  <div class="input-group">
Â  Â  Â  Â  Â  Â  <label for="location">Street/Location</label>
Â  Â  Â  Â  Â  Â  <input type="text" id="location" placeholder="e.g. Pine Street, near 7-11">
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div class="input-group">
Â  Â  Â  Â  Â  Â  <label for="desc">Issue Description</label>
Â  Â  Â  Â  Â  Â  <textarea id="desc" rows="3" placeholder="Lamp post not working, flickering, etc."></textarea>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <button type="submit" class="cta button-ripple">Submit Report</button>
Â  Â  Â  Â  </form>
Â  Â  Â  Â  <div id="feedback-msg" class="feedback" style="display:none;">
Â  Â  Â  Â  Â  Thank you! Your issue has been reported.
Â  Â  Â  Â  </div>
Â  Â  Â  </div>
Â  Â  </div>
Â  Â  <div id="route" class="screen">
Â  Â  Â  <div class="container">
Â  Â  Â  Â  <h2>Plan Your Safe Walk Route</h2>
Â  Â  Â  Â  <form id="route-form" onsubmit="event.preventDefault(); handleRoute();">
Â  Â  Â  Â  Â  <div class="input-group">
Â  Â  Â  Â  Â  Â  <label for="from">From (type or select Baguio landmark/street)</label>
Â  Â  Â  Â  Â  Â  <input list="from-list" id="from" name="from" autocomplete="off" placeholder="e.g. Burnham Park, Session Road" required>
Â  Â  Â  Â  Â  Â  <datalist id="from-list"></datalist>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  <div class="input-group">
Â  Â  Â  Â  Â  Â  <label for="to">To (type or select Baguio landmark/street)</label>
Â  Â  Â  Â  Â  Â  <input list="to-list" id="to" name="to" autocomplete="off" placeholder="e.g. SM Baguio, Wright Park" required>
Â  Â  Â  Â  Â  Â  <datalist id="to-list"></datalist>
Â  Â  Â  Â  Â  </div>
		  <button type="submit" class="cta button-ripple" onclick="showScreen('route')">Show Lighted Route</button>
Â  Â  Â  Â  </form>
Â  Â  Â  Â  <div id="route-map-container">
	<div id="route-map"></div>
Â  Â  Â  Â  </div>
	<ul id="routes" class="route-list"></ul>
Â  Â  Â  </div>
Â  Â  </div>
		<div id="profile" class="screen">
			<div class="container">
				<h2>User Profile</h2>
				<div class="user-profile-box" id="profile-view">
					<b>Name:</b> <span id="profile-name">Jane Doe</span><br>
					<b>Email:</b> <span id="profile-email">janedoe@email.com</span><br>
					<b>Preferred Area:</b> <span id="profile-area">Downtown</span>
				</div>

				<div id="profile-edit" style="display:none; margin-top:1rem;">
					<div class="input-group">
						<label for="edit-name">Name</label>
						<input type="text" id="edit-name" placeholder="Your full name">
					</div>
					<div class="input-group">
						<label for="edit-email">Email</label>
						<input type="email" id="edit-email" placeholder="you@example.com">
					</div>
					<div class="input-group">
						<label for="edit-area">Preferred Area</label>
						<input type="text" id="edit-area" placeholder="e.g. Downtown">
					</div>
					<div style="text-align:center; margin-top:0.75rem;">
						<button class="cta button-ripple" id="saveProfileBtn">Save</button>
						<button class="cta button-ripple" id="cancelProfileBtn" style="background:#888; margin-left:0.5em;">Cancel</button>
					</div>
				</div>

				<div style="text-align:center; margin-top:1rem;">
					<button id="editProfileBtn" class="cta button-ripple">Edit Profile</button>
				</div>

				<p style="text-align:center;">Customize location preferences and safety alerts.</p>
			</div>
		</div>
Â  Â  <div id="help" class="screen">
			<div class="container">
				<h2>Help / About</h2>
				<ul class="help-info" style="text-align:center;">
					<li><b>What is LitPath?</b> <br> An app to help you find the safest, best-lit routes for walking at night.</li>
					<li><b>How to report issues?</b> <br> Use the "Report Lighting" tab to submit location details.</li>
					<li><b>Where does lighting data come from?</b> <br> Public sources, user reports, and city data.</li>
				</ul>
				<button class="cta button-ripple" onclick="showScreen('home')">Back to Home</button>
			</div>
Â  Â  </div>
Â  </section>
Â  <script>
Â  Â  let litRoadLayer, litRoadGraph = null;
Â  Â  function addLitRoads(mapObject) {
Â  Â  Â  fetch('baguio-lit-roads.geojson')
Â  Â  Â  Â  .then(r => r.json())
Â  Â  Â  Â  .then(geojson => {
Â  Â  Â  Â  Â  if (litRoadLayer && mapObject.hasLayer(litRoadLayer)) {
Â  Â  Â  Â  Â  Â  mapObject.removeLayer(litRoadLayer);
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  litRoadLayer = L.geoJSON(geojson, {
Â  Â  Â  Â  Â  Â  style: { color: '#ffd700', weight: 7, opacity: 0.85 }
Â  Â  Â  Â  Â  }).addTo(mapObject);
Â  Â  Â  Â  Â  // Build graph for lit-only routing
Â  Â  Â  Â  Â  litRoadGraph = buildLitRoadGraph(geojson);
Â  Â  Â  Â  });
Â  Â  }
Â  Â  function buildLitRoadGraph(geojson) {
Â  Â  Â  let nodes = {}, edges = {};
Â  Â  Â  geojson.features.forEach(f => {
Â  Â  Â  Â  let coords = f.geometry.coordinates;
Â  Â  Â  Â  for (let i = 0; i < coords.length-1; i++) {
Â  Â  Â  Â  Â  let a = coords[i], b = coords[i+1];
Â  Â  Â  Â  Â  let a_str = a.join(','), b_str = b.join(',');
Â  Â  Â  Â  Â  nodes[a_str] = a; nodes[b_str] = b;
Â  Â  Â  Â  Â  if (!edges[a_str]) edges[a_str] = [];
Â  Â  Â  Â  Â  if (!edges[b_str]) edges[b_str] = [];
Â  Â  Â  Â  Â  let w = distance(a,b);
Â  Â  Â  Â  Â  edges[a_str].push({to: b_str, weight: w});
Â  Â  Â  Â  Â  edges[b_str].push({to: a_str, weight: w});
Â  Â  Â  Â  }
Â  Â  Â  });
Â  Â  Â  return {nodes, edges};
Â  Â  }
Â  Â  function distance(a,b) {
Â  Â  Â  let dx = a[0] - b[0], dy = a[1] - b[1];
Â  Â  Â  return Math.sqrt(dx*dx + dy*dy);
Â  Â  }
Â  Â  function nearestLitNode(nodes, latLng) {
Â  Â  Â  let minDist = Infinity, nearest = null;
Â  Â  Â  Object.keys(nodes).forEach(key => {
Â  Â  Â  Â  let n = nodes[key];
Â  Â  Â  Â  let d = distance(n, [latLng[1], latLng[0]]);
Â  Â  Â  Â  if (d < minDist) { minDist = d; nearest = key; }
Â  Â  Â  });
Â  Â  Â  return nearest;
Â  Â  }
Â  Â  function dijkstra(graph, start, end) {
Â  Â  Â  let distances = {}, prev = {}, Q = Object.keys(graph.nodes);
Â  Â  Â  Q.forEach(node => { distances[node] = Infinity; prev[node] = null; });
Â  Â  Â  distances[start] = 0;
Â  Â  Â  while (Q.length > 0) {
Â  Â  Â  Â  let u = Q.reduce((a,b) => distances[a]<distances[b]?a:b);
Â  Â  Â  Â  Q = Q.filter(n => n !== u);
Â  Â  Â  Â  if (u === end) break;
Â  Â  Â  Â  let neighbors = graph.edges[u] || [];
Â  Â  Â  Â  neighbors.forEach(({to,weight}) => {
Â  Â  Â  Â  Â  let alt = distances[u] + weight;
Â  Â  Â  Â  Â  if (alt < distances[to]) {
Â  Â  Â  Â  Â  Â  distances[to] = alt;
Â  Â  Â  Â  Â  Â  prev[to] = u;
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  });
Â  Â  Â  }
Â  Â  Â  let path = [], u = end;
Â  Â  Â  if (prev[u] || u === start) {
Â  Â  Â  Â  while(u) { path.unshift(graph.nodes[u]); u = prev[u]; }
Â  Â  Â  }
Â  Â  Â  return path.length > 1 ? path : null;
Â  Â  }
		function showScreen(id) {
			// Toggle the active screen without applying absolute positioning
			document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
			const el = document.getElementById(id);
			if (!el) return;
			el.classList.add('active');
			// Hooks
			if (id === 'map') setTimeout(initLeafletMap, 100);
			if (id === 'reports-received') updateReportsList();
			// If route screen is shown, also invalidate route map size after display
			if (id === 'route' && typeof routeMap !== 'undefined' && routeMap) {
				setTimeout(() => { try { routeMap.invalidateSize(); } catch (e) {} }, 250);
			}
		}
Â  Â  let mapInitialized = false;
Â  Â  function initLeafletMap() {
Â  Â  Â  if (mapInitialized) return;
Â  Â  Â  mapInitialized = true;
Â  Â  Â  var map = L.map('mapid').setView([16.4023, 120.5960], 14);
Â  Â  Â  L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
Â  Â  Â  Â  attribution: '&copy; OpenStreetMap contributors'
Â  Â  Â  }).addTo(map);
Â  Â  Â  addLitRoads(map);
Â  Â  Â  L.marker([16.412106172231493, 120.59620938104183]).addTo(map).bindPopup('Harrison Road: Well-lit').openPopup();
Â  Â  Â  L.marker([16.413342017732347, 120.59196839974491]).addTo(map).bindPopup('Shuntug Street: Lights Out');
Â  Â  Â  L.marker([16.413842396114, 120.59403589212037]).addTo(map).bindPopup('Abanao Street: Dimly Lit');
Â  Â  }
Â  Â  function addRippleToButtons() {
Â  Â  Â  document.querySelectorAll('button.button-ripple').forEach(btn => {
Â  Â  Â  Â  btn.removeEventListener('click', buttonRippleHandler);
Â  Â  Â  Â  btn.addEventListener('click', buttonRippleHandler);
Â  Â  Â  });
Â  Â  }

		function setupNavToggle() {
			const toggle = document.getElementById('navToggle');
			const links = document.querySelector('.nav-links');
			if (!toggle || !links) return;
			toggle.addEventListener('click', () => {
				const isOpen = links.classList.toggle('open');
				toggle.setAttribute('aria-expanded', isOpen ? 'true' : 'false');
			});
			// Close menu on nav link click (mobile)
			links.querySelectorAll('button').forEach(b => {
				b.addEventListener('click', () => {
					if (window.innerWidth <= 800) {
						links.classList.remove('open');
						toggle.setAttribute('aria-expanded', 'false');
					}
				});
			});
			// Ensure menu closes when resizing larger
			window.addEventListener('resize', () => {
				if (window.innerWidth > 800) {
					links.classList.remove('open');
					toggle.setAttribute('aria-expanded', 'false');
				}
			});
		}
Â  Â  function buttonRippleHandler(e) {
Â  Â  Â  const btn = e.currentTarget;
Â  Â  Â  const ripple = document.createElement('span');
Â  Â  Â  ripple.className = 'ripple';
Â  Â  Â  btn.appendChild(ripple);
Â  Â  Â  const rect = btn.getBoundingClientRect();
Â  Â  Â  const x = e.clientX - rect.left;
Â  Â  Â  const y = e.clientY - rect.top;
Â  Â  Â  ripple.style.left = `${x - 50}px`;
Â  Â  Â  ripple.style.top = `${y - 50}px`;
Â  Â  Â  setTimeout(() => ripple.remove(), 600);
Â  Â  }
Â  Â  document.addEventListener('DOMContentLoaded', addRippleToButtons);
Â  Â  setTimeout(addRippleToButtons, 500);
	document.addEventListener('DOMContentLoaded', setupNavToggle);

Â  Â  // Make sure all relevant buttons in Welcome and Report page have the .button-ripple class
Â  Â  document.addEventListener('DOMContentLoaded', () => {
Â  Â  Â  // Already set in HTML above! But in case buttons were added differently, you can enforce:
Â  Â  Â  document.querySelectorAll('#onboarding .cta, #report .cta').forEach(btn => {
Â  Â  Â  Â  if(!btn.classList.contains('button-ripple')) btn.classList.add('button-ripple');
Â  Â  Â  });
Â  Â  });

Â  Â  const BAGUIO_PLACES = {
Â  Â  Â  "Burnham Park": [16.411288043321626, 120.5952399352773],
Â  Â  Â  "SM Baguio": [16.408817413714342, 120.59993055716927],
Â  Â  Â  "Session Road": [16.412823925431432, 120.59712107088126],
Â  Â  Â  "Wright Park": [16.41388501369341, 120.62021834748622],
Â  Â  Â  "Camp John Hay": [16.398826505919434, 120.60741055507336],
Â  Â  Â  "Botanical Garden": [16.415038097800576, 120.61284777118958],
Â  Â  Â  "Loakan Airport": [16.3755762027204, 120.61255987208509],
Â  Â  Â  "Baguio Cathedral": [16.41189562604635, 120.59907255562801],
Â  Â  Â  "City Market": [16.41493207693937, 120.59553589097696],
Â  Â  Â  "Mines View Park": [16.41962743286897, 120.62681486991416],
Â  Â  Â  "Teachers Camp": [16.41251327297253, 120.60914337483861],
Â  Â  Â  "Pink Sisters Convent": [16.411559653203852, 120.6036464234618],
Â  Â  Â  "John Hay Technohub": [16.3987746627249, 120.60846602150573],
Â  Â  Â  "Baguio Convention Center": [16.40488492925696, 120.5995014890064],
Â  Â  Â  "Mirador Heritage": [16.409903448853, 120.58000377643049],
Â  Â  Â  "Good Shepherd": [16.41259851360554, 120.59827205038131],
Â  Â  Â  "Harrison Road": [16.412107218031572, 120.59617220980469],
Â  Â  Â  "Lourdes Grotto": [16.410479502302515, 120.58140841346537],
Â  Â  Â  "Scout Hill": [16.3979312905935, 120.6160289167217],
Â  Â  Â  "Aurora Hill": [16.426844404140244, 120.60742207159154]
Â  Â  };
Â  Â  let routeMap;
Â  Â  let routeControl;
Â  Â  let litRouteLayer;
Â  Â  document.addEventListener('DOMContentLoaded', () => {
Â  Â  Â  let options = Object.keys(BAGUIO_PLACES).map(p => `<option value="${p}">`);
Â  Â  Â  document.getElementById('from-list').innerHTML = options.join('');
Â  Â  Â  document.getElementById('to-list').innerHTML = options.join('');
Â  Â  Â  document.getElementById('from').value = "Burnham Park";
Â  Â  Â  document.getElementById('to').value = "SM Baguio";
Â  Â  });
Â  Â  async function handleRoute() {
Â  Â  Â  const fromInput = document.getElementById('from').value.trim(), toInput = document.getElementById('to').value.trim();
Â  Â  Â  if (!BAGUIO_PLACES[fromInput] || !BAGUIO_PLACES[toInput]) {
Â  Â  Â  Â  alert('Please select or type valid Baguio locations from the suggestions.');
Â  Â  Â  Â  return;
Â  Â  Â  }
Â  Â  Â  if (fromInput === toInput) {
Â  Â  Â  Â  alert("Select two different locations.");
Â  Â  Â  Â  return;
Â  Â  Â  }
Â  Â  Â  document.getElementById('route-map').style.display = "block";
Â  Â  Â  document.getElementById('routes').style.display = "block";
Â  Â  Â  const fromCoords = BAGUIO_PLACES[fromInput];
Â  Â  Â  const toCoords = BAGUIO_PLACES[toInput];
			if (!routeMap) {
				routeMap = L.map('route-map').setView(fromCoords, 14);
				L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
					attribution: '&copy; OpenStreetMap contributors'
				}).addTo(routeMap);
				addLitRoads(routeMap);
				// Leaflet needs to be notified after the container size changes or the map is first shown
				setTimeout(() => { try { routeMap.invalidateSize(); } catch (e) {} }, 250);
			} else {
				routeMap.setView(fromCoords, 14);
				if (routeControl) routeMap.removeControl(routeControl);
				if (litRouteLayer && routeMap.hasLayer(litRouteLayer)) routeMap.removeLayer(litRouteLayer);
				addLitRoads(routeMap);
				setTimeout(() => { try { routeMap.invalidateSize(); } catch (e) {} }, 250);
			}
Â  Â  Â  if (litRoadGraph) {
Â  Â  Â  Â  let startNode = nearestLitNode(litRoadGraph.nodes, [fromCoords[1], fromCoords[0]]);
Â  Â  Â  Â  let endNode = nearestLitNode(litRoadGraph.nodes, [toCoords[1], toCoords[0]]);
Â  Â  Â  Â  let litPath = dijkstra(litRoadGraph, startNode, endNode);
Â  Â  Â  Â  if (litPath && litPath.length>1) {
Â  Â  Â  Â  Â  if (litRouteLayer && routeMap.hasLayer(litRouteLayer)) routeMap.removeLayer(litRouteLayer);
Â  Â  Â  Â  Â  litRouteLayer = L.polyline(litPath.map(p=>[p[1],p[0]]), {color:'#ffd700',weight:8,opacity:0.9}).addTo(routeMap);
Â  Â  Â  Â  Â  L.marker([fromCoords[0], fromCoords[1]]).addTo(routeMap).bindPopup("Start: " + fromInput).openPopup();
Â  Â  Â  Â  Â  L.marker([toCoords[0], toCoords[1]]).addTo(routeMap).bindPopup("End: " + toInput);
Â  Â  Â  Â  Â  document.getElementById('routes').innerHTML = `<li><b>Route (well-lit only):</b> ${fromInput} &rarr; ${toInput}</li>`;
Â  Â  Â  Â  Â  return;
Â  Â  Â  Â  }
Â  Â  Â  }
			routeControl = L.Routing.control({
				waypoints: [
					L.latLng(fromCoords[0], fromCoords[1]),
					L.latLng(toCoords[0], toCoords[1])
				],
				routeWhileDragging: false,
				show: false,
				draggableWaypoints: false,
				addWaypoints: false,
				lineOptions: {
					styles: [{color: '#2983d7', weight: 7, opacity: 0.7}]
				},
				createMarker: function(i, wp, nWps) {
					return L.marker(wp.latLng).bindPopup(i===0 ? ('Start: ' + fromInput) : ('End: ' + toInput));
				}
			}).addTo(routeMap);
Â  Â  Â  document.getElementById('routes').innerHTML = `<li><b>Route:</b> ${fromInput} &rarr; ${toInput} <br> (well-lit path not available, showing shortest route)</li>`;
Â  Â  }
		// --- Profile editing: load/save, render, and handlers ---
		function loadProfile() {
			const raw = localStorage.getItem('litpath_profile');
			if (!raw) return { name: 'Jane Doe', email: 'janedoe@email.com', area: 'Downtown' };
			try { return JSON.parse(raw); } catch(e) { return { name: 'Jane Doe', email: 'janedoe@email.com', area: 'Downtown' }; }
		}
		function saveProfile(profile) {
			localStorage.setItem('litpath_profile', JSON.stringify(profile));
		}
		function renderProfile() {
			const p = loadProfile();
			document.getElementById('profile-name').textContent = p.name;
			document.getElementById('profile-email').textContent = p.email;
			document.getElementById('profile-area').textContent = p.area;
		}
		function enterEditMode() {
			const p = loadProfile();
			document.getElementById('edit-name').value = p.name || '';
			document.getElementById('edit-email').value = p.email || '';
			document.getElementById('edit-area').value = p.area || '';
			document.getElementById('profile-view').style.display = 'none';
			document.getElementById('profile-edit').style.display = 'block';
			document.getElementById('editProfileBtn').style.display = 'none';
		}
		function exitEditMode() {
			document.getElementById('profile-view').style.display = 'block';
			document.getElementById('profile-edit').style.display = 'none';
			document.getElementById('editProfileBtn').style.display = 'inline-block';
			renderProfile();
		}
		document.addEventListener('DOMContentLoaded', () => {
			renderProfile();
			const editBtn = document.getElementById('editProfileBtn');
			if (editBtn) editBtn.addEventListener('click', enterEditMode);
			const saveBtn = document.getElementById('saveProfileBtn');
			if (saveBtn) saveBtn.addEventListener('click', () => {
				const name = document.getElementById('edit-name').value.trim();
				const email = document.getElementById('edit-email').value.trim();
				const area = document.getElementById('edit-area').value.trim();
				if (!name) { alert('Please enter a name.'); return; }
				if (email && !/^[^@\s]+@[^@\s]+\.[^@\s]+$/.test(email)) { alert('Please enter a valid email or leave blank.'); return; }
				saveProfile({ name, email: email || 'â€”', area: area || 'â€”' });
				exitEditMode();
			});
			const cancelBtn = document.getElementById('cancelProfileBtn');
			if (cancelBtn) cancelBtn.addEventListener('click', () => { exitEditMode(); });
		});
Â  </script>
</body>
</html>

